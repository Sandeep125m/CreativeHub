<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CreativeHub | My Requests</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
    <style>
        .request-status-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px; }
        .status-card { background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); text-align: center; }
        .status-card p { font-size: 14px; color: #666; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; }
        .status-card .count { font-size: 36px; font-weight: bold; margin: 0; }
        
        .pending { color: #ffc107; } /* Orange */
        .in-progress { color: #00bcd4; } /* Cyan/Blue */
        .completed { color: #28a745; } /* Green */
        .cancelled { color: #dc3545; } /* Red */

        .no-requests-box { text-align: center; padding: 80px 40px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .create-request-btn { background-color: black; color: white; padding: 12px 25px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-top: 20px; font-size: 16px; }

        table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 12px;
      overflow: hidden;
      background-color: white;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
    }

    th, td {
      text-align: left;
      padding: 14px 20px;
    }

    th {
      background-color: #f9fafb;
      font-weight: 600;
      color: #333;
      border-bottom: 1px solid #eee;
    }

    td {
      border-bottom: 1px solid #f2f2f2;
      vertical-align: middle;
      color: #333;
    }

    tr:last-child td {
      border-bottom: none;
    }

    .title-main {
      font-weight: 600;
    }

    .title-sub {
      font-size: 13px;
      color: #7c7c7c;
      display: block;
      margin-top: 4px;
    }

    .edit-btn {
      background-color: #f3f4f6;
      border: none;
      padding: 4px 12px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
    }

    .status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 4px 10px;
      color: #555;
      background-color: #fff;
    }

    .status::before {
      content: "‚è±Ô∏è";
      font-size: 14px;
    }

    .credits {
      color: #a020f0;
      font-weight: 500;
    }

    .completed {
      color: #999;
    }

    tr:hover {
      background-color: #fafafa;
    }

    header-request{
      padding: 10px 0;
    }
    
    </style>
</head>
<body>

    <div class="main-container">
        <div class="sidebar">
            <a href="{{ url_for('home') }}">
                <div style="padding: 0 20px; font-weight: bold; margin-bottom: 30px; font-size: 20px;">CreativeHub</div>
            </a>
            <nav class="sidebar-menu">
                <a href="{{ url_for('dashboard') }}" >
                    <span class="icon">üìä</span> Dashboard
                </a>
                <a href="/new_request">
                    <span class="icon">+</span> New Request
                </a>
                <a href="/my_requests" class="active">
                    <span class="icon">üìú</span> My Requests
                </a>
                <a href="/buy_package">
                    <span class="icon">üì¶</span> Buy Package
                </a>
                <a href="/buy_credits">
                    <span class="icon">üí≥</span> Buy Credits
                </a>
                <a href="/credit_history">
                    <span class="icon">üïí</span> Credit History
                </a>
                <a href="/settings">
                    <span class="icon">‚öôÔ∏è</span> Settings
                </a>
            </nav>
            <div style="padding: 20px; margin-top: 50px;">
                <p>Need Help?</p>
                <button style="background-color: #5a5aff; color: white; padding: 10px; border: none; border-radius: 4px; width: 100%; cursor: pointer;">Get Support</button>
            </div>
        </div>

        <div class="content">
            <div class="header">
                <div class="credit-info">{{ available_credits }} credits</div>
                <a href="{{ url_for('logout') }}">Logout ‚Üí</a>
            </div>

            <div class="content-header">
                <h2>My Requests</h2>
                <p style="color: #666; margin-top: -20px; margin-bottom: 20px;">Track all your design requests</p>
                <a href="/new_request" class="header-request">
                    <button class="create-request-btn" style="background-color: #333;">+ New Request</button>
                </a>
            </div>  

            <div class="request-status-grid">
                
                <div class="status-card">
                    <p class="pending"><span style="margin-right: 5px;">üïë</span> Pending</p>
                    <p class="count pending">{{ statuses.pending }}</p>
                </div>

                <div class="status-card">
                    <p class="in-progress"><span style="margin-right: 5px;">‚ú®</span> In Progress</p>
                    <p class="count in-progress">{{ statuses.in_progress }}</p>
                </div>
                
                <div class="status-card">
                    <p class="completed"><span style="margin-right: 5px;">‚úÖ</span> Completed</p>
                    <p class="count completed">{{ statuses.completed }}</p>
                </div>
                
                <div class="status-card">
                    <p class="cancelled"><span style="margin-right: 5px;">‚ùå</span> Cancelled</p>
                    <p class="count cancelled">{{ statuses.cancelled }}</p>
                </div>
            </div>

            <div class="no-requests-box">
  {% if requests_list %}
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Title</th>
        <th>Type</th>
        <th>Status</th>
        <th>Credits</th>
        <th>Completed</th>
      </tr>
    </thead>
    
    </thead>
            <tbody>
            {% for req in requests_list %}
            <tr>
                <td>{{ req.created_at.strftime('%m/%d/%Y') }}</td>
                <td>
                    <span class="title-main">{{ req.title }}</span>
                    <span class="title-sub">{{ req.description[:40] }}...</span>
                </td>
                <td><button class="edit-btn">{{ req.service_type }}</button></td>
                <td>
                    <span class="status">
                        {% if req.status == 'Pending' %}‚è±Ô∏è Pending
                        {% elif req.status == 'In Progress' %}‚ú® In Progress
                        {% elif req.status == 'Completed' %}‚úÖ Completed
                        {% elif req.status == 'Cancelled' %}‚ùå Cancelled
                        {% endif %}
                    </span>
                </td>
                <td class="credits">
                    {{ SERVICE_CREDIT_COST.get(req.service_type, 0) }}
                </td>
                <td class="completed">
                    {% if req.status == 'Completed' %}
                        {{ req.created_at.strftime('%m/%d/%Y') }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if req.status in ['Pending', 'In Progress'] %}
                    <form action="{{ url_for('cancel_request', request_id=req.id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="edit-btn" style="background-color:#dc3545; color:white;">Cancel</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="font-size: 18px; color: #555;">No requests yet</p>
        <p style="color: #999;">Submit your first design request to get started</p>
        <a href="/new-request"><button class="create-request-btn">+ Create Request</button></a>
        {% endif %}
        </div>

        </div>
    </div>

</body>
</html>